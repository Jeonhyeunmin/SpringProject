<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.spring.javaGroupS6.dao.ShopDAO">
	
	<select id="getShopList" resultType="com.spring.javaGroupS6.vo.ShopVO">
		select * from shop where category = #{category} and accept = '승인' order by category;
	</select>
	
	<select id="getMainShopList" resultType="com.spring.javaGroupS6.vo.ShopVO">
		select * from shop where mainCategory = #{mainCategory} and accept = '승인' order by subCategory;
	</select>
	
	<select id="getSubCateCnt" resultType="int">
		select COUNT(*) as count from shop where mainCategory = #{mainCategory} and accept = '승인'  group by subCategory order by subCategory;
	</select>
	
	<select id="getSubShopAllList" resultType="com.spring.javaGroupS6.vo.ShopVO">
		select * from shop where subCategory = #{subCategory} and accept = '승인'  order by subCategory;
	</select>
	
	<select id="getBrandCateCnt" resultType="int">
		select COUNT(*) as count from shop where subCategory = #{subCategory} and accept = '승인'  group by company order by company;
	</select>
	
	<select id="getSubShopList" resultType="com.spring.javaGroupS6.vo.ShopVO">
		select * from shop where subCategory = #{subCategory} and accept = '승인' <if test='company != "all"'>and company = #{company}</if>  order by subCategory;
	</select>
	
	<select id="getShopContent" resultType="com.spring.javaGroupS6.vo.ShopVO">
		select * from shop where idx = #{idx};
	</select>
	
	<select id="getList" resultType="com.spring.javaGroupS6.vo.ShopVO">
		select * from shop order by category;
	</select>
	
	<select id="getPostCount" resultType="int">
		select count(*) from shop where mid = #{mid};
	</select>
	
	<insert id="shopInput">
		insert into shop values (default, #{vo.mid}, #{vo.company}, #{vo.category}, #{vo.mainCategory}, #{vo.subCategory}, #{vo.title}, #{vo.discount}, #{vo.price}, #{vo.thumbnail}, #{vo.titleImg}, #{vo.content}, #{vo.fSize}, default, default, default);
	</insert>
	
	<update id="setShopUpdate">
		update shop set company = #{vo.company}, category = #{vo.category}, mainCategory = #{vo.mainCategory}, subCategory = #{vo.subCategory}, title = #{vo.title}, discount = #{vo.discount}, price = #{vo.price}, thumbnail = #{vo.thumbnail}, titleImg = #{vo.titleImg}, content = #{vo.content}, fSize = #{vo.fSize}, wDate = now(), accept = 'NO' where idx = #{vo.idx};
	</update>
	
	<delete id="setShopDelete">
		delete from shop where idx = #{idx};
	</delete>
	
</mapper>